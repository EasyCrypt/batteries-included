<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<link rel="stylesheet" href="style.css" type="text/css">
<meta content="text/html; charset=iso-8859-1" http-equiv="Content-Type">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="Start" href="index.html">
<link rel="previous" href="Batteries.Global.html">
<link rel="next" href="Batteries.LazyList.html">
<link rel="Up" href="Batteries.html">
<link title="Index of types" rel=Appendix href="index_types.html">
<link title="Index of exceptions" rel=Appendix href="index_exceptions.html">
<link title="Index of values" rel=Appendix href="index_values.html">
<link title="Index of class methods" rel=Appendix href="index_methods.html">
<link title="Index of classes" rel=Appendix href="index_classes.html">
<link title="Index of modules" rel=Appendix href="index_modules.html">
<link title="Index of module types" rel=Appendix href="index_module_types.html">
<link title="BatArray" rel="Chapter" href="BatArray.html">
<link title="BatAvlTree" rel="Chapter" href="BatAvlTree.html">
<link title="BatBase64" rel="Chapter" href="BatBase64.html">
<link title="BatBig_int" rel="Chapter" href="BatBig_int.html">
<link title="BatBigarray" rel="Chapter" href="BatBigarray.html">
<link title="BatBitSet" rel="Chapter" href="BatBitSet.html">
<link title="BatBool" rel="Chapter" href="BatBool.html">
<link title="BatBounded" rel="Chapter" href="BatBounded.html">
<link title="BatBuffer" rel="Chapter" href="BatBuffer.html">
<link title="BatBytes" rel="Chapter" href="BatBytes.html">
<link title="BatBytesCompat" rel="Chapter" href="BatBytesCompat.html">
<link title="BatCache" rel="Chapter" href="BatCache.html">
<link title="BatChar" rel="Chapter" href="BatChar.html">
<link title="BatCharParser" rel="Chapter" href="BatCharParser.html">
<link title="BatComplex" rel="Chapter" href="BatComplex.html">
<link title="BatConcreteQueue" rel="Chapter" href="BatConcreteQueue.html">
<link title="BatConcurrent" rel="Chapter" href="BatConcurrent.html">
<link title="BatDeque" rel="Chapter" href="BatDeque.html">
<link title="BatDigest" rel="Chapter" href="BatDigest.html">
<link title="BatDllist" rel="Chapter" href="BatDllist.html">
<link title="BatDynArray" rel="Chapter" href="BatDynArray.html">
<link title="BatEnum" rel="Chapter" href="BatEnum.html">
<link title="BatFile" rel="Chapter" href="BatFile.html">
<link title="BatFilename" rel="Chapter" href="BatFilename.html">
<link title="BatFingerTree" rel="Chapter" href="BatFingerTree.html">
<link title="BatFloat" rel="Chapter" href="BatFloat.html">
<link title="BatFormat" rel="Chapter" href="BatFormat.html">
<link title="BatGc" rel="Chapter" href="BatGc.html">
<link title="BatGenlex" rel="Chapter" href="BatGenlex.html">
<link title="BatGlobal" rel="Chapter" href="BatGlobal.html">
<link title="BatHashcons" rel="Chapter" href="BatHashcons.html">
<link title="BatHashtbl" rel="Chapter" href="BatHashtbl.html">
<link title="BatHeap" rel="Chapter" href="BatHeap.html">
<link title="BatIMap" rel="Chapter" href="BatIMap.html">
<link title="BatIO" rel="Chapter" href="BatIO.html">
<link title="BatISet" rel="Chapter" href="BatISet.html">
<link title="BatInnerIO" rel="Chapter" href="BatInnerIO.html">
<link title="BatInnerPervasives" rel="Chapter" href="BatInnerPervasives.html">
<link title="BatInnerShuffle" rel="Chapter" href="BatInnerShuffle.html">
<link title="BatInnerWeaktbl" rel="Chapter" href="BatInnerWeaktbl.html">
<link title="BatInt" rel="Chapter" href="BatInt.html">
<link title="BatInt32" rel="Chapter" href="BatInt32.html">
<link title="BatInt64" rel="Chapter" href="BatInt64.html">
<link title="BatInterfaces" rel="Chapter" href="BatInterfaces.html">
<link title="BatLazyList" rel="Chapter" href="BatLazyList.html">
<link title="BatLexing" rel="Chapter" href="BatLexing.html">
<link title="BatList" rel="Chapter" href="BatList.html">
<link title="BatLog" rel="Chapter" href="BatLog.html">
<link title="BatLogger" rel="Chapter" href="BatLogger.html">
<link title="BatMap" rel="Chapter" href="BatMap.html">
<link title="BatMarshal" rel="Chapter" href="BatMarshal.html">
<link title="BatMultiMap" rel="Chapter" href="BatMultiMap.html">
<link title="BatMultiPMap" rel="Chapter" href="BatMultiPMap.html">
<link title="BatMutex" rel="Chapter" href="BatMutex.html">
<link title="BatNativeint" rel="Chapter" href="BatNativeint.html">
<link title="BatNum" rel="Chapter" href="BatNum.html">
<link title="BatNumber" rel="Chapter" href="BatNumber.html">
<link title="BatOpaqueInnerSys" rel="Chapter" href="BatOpaqueInnerSys.html">
<link title="BatOptParse" rel="Chapter" href="BatOptParse.html">
<link title="BatOption" rel="Chapter" href="BatOption.html">
<link title="BatOrd" rel="Chapter" href="BatOrd.html">
<link title="BatParserCo" rel="Chapter" href="BatParserCo.html">
<link title="BatPathGen" rel="Chapter" href="BatPathGen.html">
<link title="BatPervasives" rel="Chapter" href="BatPervasives.html">
<link title="BatPrintexc" rel="Chapter" href="BatPrintexc.html">
<link title="BatPrintf" rel="Chapter" href="BatPrintf.html">
<link title="BatQueue" rel="Chapter" href="BatQueue.html">
<link title="BatRMutex" rel="Chapter" href="BatRMutex.html">
<link title="BatRandom" rel="Chapter" href="BatRandom.html">
<link title="BatRef" rel="Chapter" href="BatRef.html">
<link title="BatRefList" rel="Chapter" href="BatRefList.html">
<link title="BatResult" rel="Chapter" href="BatResult.html">
<link title="BatReturn" rel="Chapter" href="BatReturn.html">
<link title="BatScanf" rel="Chapter" href="BatScanf.html">
<link title="BatSeq" rel="Chapter" href="BatSeq.html">
<link title="BatSet" rel="Chapter" href="BatSet.html">
<link title="BatSplay" rel="Chapter" href="BatSplay.html">
<link title="BatStack" rel="Chapter" href="BatStack.html">
<link title="BatStream" rel="Chapter" href="BatStream.html">
<link title="BatString" rel="Chapter" href="BatString.html">
<link title="BatSubstring" rel="Chapter" href="BatSubstring.html">
<link title="BatSys" rel="Chapter" href="BatSys.html">
<link title="BatText" rel="Chapter" href="BatText.html">
<link title="BatTuple" rel="Chapter" href="BatTuple.html">
<link title="BatUChar" rel="Chapter" href="BatUChar.html">
<link title="BatUTF8" rel="Chapter" href="BatUTF8.html">
<link title="BatUnit" rel="Chapter" href="BatUnit.html">
<link title="BatUnix" rel="Chapter" href="BatUnix.html">
<link title="BatUref" rel="Chapter" href="BatUref.html">
<link title="BatVect" rel="Chapter" href="BatVect.html">
<link title="Batteries" rel="Chapter" href="Batteries.html">
<link title="BatteriesConfig" rel="Chapter" href="BatteriesConfig.html">
<link title="BatteriesExceptionless" rel="Chapter" href="BatteriesExceptionless.html">
<link title="BatteriesPrint" rel="Chapter" href="BatteriesPrint.html">
<link title="BatteriesThread" rel="Chapter" href="BatteriesThread.html">
<link title="Extlib" rel="Chapter" href="Extlib.html"><link title="Standard inputs/outputs" rel="Section" href="#6_Standardinputsoutputs">
<link title="Standard API" rel="Section" href="#6_StandardAPI">
<link title="Creation of BatIO Inputs/Outputs" rel="Section" href="#6_CreationofBatIOInputsOutputs">
<link title="Utilities" rel="Section" href="#6_Utilities">
<link title="Binary files API" rel="Section" href="#6_BinaryfilesAPI">
<link title="Bits API" rel="Section" href="#6_BitsAPI">
<link title="Creating new types of inputs/outputs" rel="Section" href="#6_Creatingnewtypesofinputsoutputs">
<link title="For compatibility purposes" rel="Section" href="#6_Forcompatibilitypurposes">
<link title="Generic BatIO Object Wrappers" rel="Section" href="#6_GenericBatIOObjectWrappers">
<link title="Enumeration API" rel="Section" href="#6_EnumerationAPI">
<link title="Thread-safety" rel="Section" href="#6_Threadsafety">
<link title="Thread-safety internals" rel="Section" href="#6_Threadsafetyinternals">
<title>Batteries user guide : Batteries.IO</title>
</head>
<body>
<div class="navbar"><a class="pre" href="Batteries.Global.html" title="Batteries.Global">Previous</a>
&nbsp;<a class="up" href="Batteries.html" title="Batteries">Up</a>
&nbsp;<a class="post" href="Batteries.LazyList.html" title="Batteries.LazyList">Next</a>
</div>
<h1>Module <a href="type_Batteries.IO.html">Batteries.IO</a></h1>

<pre><span id="MODULEIO"><span class="keyword">module</span> IO</span>: <code class="type"><a href="BatIO.html">BatIO</a></code></pre><hr width="100%">

<pre><span id="TYPEinput"><span class="keyword">type</span> <code class="type"></code>input</span> = <code class="type"><a href="BatInnerIO.html#TYPEinput">BatInnerIO.input</a></code> </pre>
<div class="info ">
<div class="info-desc">
<p>The abstract input type.</p>
</div>
</div>


<pre><span id="TYPEoutput"><span class="keyword">type</span> <code class="type">'a</code> output</span> = <code class="type">'a <a href="BatInnerIO.html#TYPEoutput">BatInnerIO.output</a></code> </pre>
<div class="info ">
<div class="info-desc">
<p>The abstract output type, <code class="code"><span class="keywordsign">'</span>a</code> is the accumulator data, it is returned
    when the <code class="code">close_out</code> function is called.</p>
</div>
</div>


<pre><span id="TYPEprinter"><span class="keyword">type</span> <code class="type">('a, 'b)</code> printer</span> = <code class="type">'b <a href="BatIO.html#TYPEoutput">output</a> -> 'a -> unit</code> </pre>
<div class="info ">
<div class="info-desc">
<p>The type of a printing function to print a <code class="code"><span class="keywordsign">'</span>a</code> to an output that
    produces <code class="code"><span class="keywordsign">'</span>b</code> as result.</p>
</div>
</div>


<pre><span id="TYPEf_printer"><span class="keyword">type</span> <code class="type">'a</code> f_printer</span> = <code class="type">Stdlib.Format.formatter -> 'a -> unit</code> </pre>


<pre><span id="EXCEPTIONNo_more_input"><span class="keyword">exception</span> No_more_input</span></pre>
<div class="info ">
<div class="info-desc">
<p>This exception is raised when reading on an input with the <code class="code">read</code> or
    <code class="code">nread</code> functions while there is no available token to read.</p>
</div>
</div>

<pre><span id="EXCEPTIONInput_closed"><span class="keyword">exception</span> Input_closed</span></pre>
<div class="info ">
<div class="info-desc">
<p>This exception is raised when reading on a closed input.</p>
</div>
</div>

<pre><span id="EXCEPTIONOutput_closed"><span class="keyword">exception</span> Output_closed</span></pre>
<div class="info ">
<div class="info-desc">
<p>This exception is raised when reading on a closed output.</p>
</div>
</div>
<h7 id="6_Standardinputsoutputs">Standard inputs/outputs</h7>
<pre><span id="VALstdin"><span class="keyword">val</span> stdin</span> : <code class="type"><a href="BatIO.html#TYPEinput">input</a></code></pre><div class="info ">
<div class="info-desc">
<p>Standard input, as per Unix/Windows conventions (by default, keyboard).</p>

<p>Example: <code class="code"><span class="keyword">if</span>&nbsp;read_line&nbsp;stdin&nbsp;|&gt;&nbsp;<span class="constructor">Int</span>.of_string&nbsp;&gt;&nbsp;10&nbsp;<span class="keyword">then</span>&nbsp;failwith&nbsp;<span class="string">"too&nbsp;big&nbsp;a&nbsp;number&nbsp;read"</span>;&nbsp;</code></p>
</div>
</div>

<pre><span id="VALstdout"><span class="keyword">val</span> stdout</span> : <code class="type">unit <a href="BatIO.html#TYPEoutput">output</a></code></pre><div class="info ">
<div class="info-desc">
<p>Standard output, as per Unix/Windows conventions (by default, console).</p>

<p>Use this output to display regular messages.
    Example: <code class="code"><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;write_string&nbsp;stdout&nbsp;<span class="string">"Enter&nbsp;your&nbsp;name:"</span>;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;name&nbsp;=&nbsp;read_line&nbsp;stdin&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;write_line&nbsp;stdout&nbsp;(<span class="string">"Your&nbsp;name&nbsp;is&nbsp;"</span>&nbsp;^&nbsp;name);<br>
&nbsp;&nbsp;&nbsp;&nbsp;</code></p>
</div>
</div>

<pre><span id="VALstderr"><span class="keyword">val</span> stderr</span> : <code class="type">unit <a href="BatIO.html#TYPEoutput">output</a></code></pre><div class="info ">
<div class="info-desc">
<p>Standard error output, as per Unix/Windows conventions.</p>

<p>Use this output to display warnings and error messages.</p>

<p>Example: <code class="code"><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;write_line&nbsp;stderr&nbsp;<span class="string">"Error&nbsp;on&nbsp;Internet&nbsp;-&nbsp;please&nbsp;delete&nbsp;google.com"</span>;<br>
&nbsp;&nbsp;&nbsp;&nbsp;</code></p>
</div>
</div>

<pre><span id="VALstdnull"><span class="keyword">val</span> stdnull</span> : <code class="type">unit <a href="BatIO.html#TYPEoutput">output</a></code></pre><div class="info ">
<div class="info-desc">
<p>An output which discards everything written to it.</p>

<p>Use this output to ignore messages.</p>

<p>Example: <code class="code"><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;out_ch&nbsp;=&nbsp;<span class="keyword">if</span>&nbsp;debug&nbsp;<span class="keyword">then</span>&nbsp;stderr&nbsp;<span class="keyword">else</span>&nbsp;stdnull&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;write_line&nbsp;out_ch&nbsp;<span class="string">"Program&nbsp;running."</span>;<br>
&nbsp;&nbsp;&nbsp;&nbsp;</code></p>
</div>
</div>
<h7 id="6_StandardAPI">Standard API</h7>
<pre><span id="VALread"><span class="keyword">val</span> read</span> : <code class="type"><a href="BatIO.html#TYPEinput">input</a> -> char</code></pre><div class="info ">
<div class="info-desc">
<p>Read a single char from an input or raise <code class="code"><span class="constructor">No_more_input</span></code> if
    no input is available.</p>

<p>Example: <code class="code"><span class="keyword">let</span>&nbsp;<span class="keyword">rec</span>&nbsp;skip_line&nbsp;ch&nbsp;=&nbsp;<span class="keyword">if</span>&nbsp;read&nbsp;ch&nbsp;=&nbsp;<span class="string">'\n'</span>&nbsp;<span class="keyword">then</span>&nbsp;skip_line&nbsp;ch&nbsp;<span class="keyword">else</span>&nbsp;();</code></p>
</div>
</div>

<pre><span id="VALnread"><span class="keyword">val</span> nread</span> : <code class="type"><a href="BatIO.html#TYPEinput">input</a> -> int -> string</code></pre><div class="info ">
<div class="info-desc">
<p><code class="code">nread&nbsp;i&nbsp;n</code> reads a string of size up to <code class="code">n</code> from an input.
    The function will raise <code class="code"><span class="constructor">No_more_input</span></code> if no input is available.
    It will raise <code class="code"><span class="constructor">Invalid_argument</span></code> if <code class="code">n</code> &lt; 0.</p>

<p>Example: <code class="code"><span class="keyword">let</span>&nbsp;read_md5&nbsp;ch&nbsp;=&nbsp;nread&nbsp;ch&nbsp;32</code></p>
</div>
</div>

<pre><span id="VALreally_nread"><span class="keyword">val</span> really_nread</span> : <code class="type"><a href="BatIO.html#TYPEinput">input</a> -> int -> string</code></pre><div class="info ">
<div class="info-desc">
<p><code class="code">really_nread&nbsp;i&nbsp;n</code> reads a string of exactly <code class="code">n</code> characters
    from the input.</p>
</div>
<ul class="info-attributes">
<li><b>Raises</b><ul><li><code>No_more_input</code> if at least <code class="code">n</code> characters are
    not available.</li>
<li><code>Invalid_argument</code> if <code class="code">n</code> &lt; 0.

    Example: <code class="code"><span class="keyword">let</span>&nbsp;read_md5&nbsp;ch&nbsp;=&nbsp;really_nread&nbsp;ch&nbsp;32</code></li>
</ul></li>
</ul>
</div>

<pre><span id="VALinput"><span class="keyword">val</span> input</span> : <code class="type"><a href="BatIO.html#TYPEinput">input</a> -> Stdlib.Bytes.t -> int -> int -> int</code></pre><div class="info ">
<div class="info-desc">
<p><code class="code">input&nbsp;i&nbsp;s&nbsp;p&nbsp;len</code> reads up to <code class="code">len</code> characters from the given input,
    storing them in byte sequence <code class="code">s</code>, starting at character number <code class="code">p</code>. It
    returns the actual number of characters read (which may be 0) or
    raise <code class="code"><span class="constructor">No_more_input</span></code> if no character can be read. It will raise
    <code class="code"><span class="constructor">Invalid_argument</span></code> if <code class="code">p</code> and <code class="code">len</code> do not designate a valid
    subsequence of <code class="code">s</code>.</p>

<p>Example: <code class="code"><span class="keyword">let</span>&nbsp;map_ch&nbsp;f&nbsp;?(block_size=100)&nbsp;=<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;b&nbsp;=&nbsp;<span class="constructor">String</span>.create&nbsp;block_size&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">try</span>&nbsp;<span class="keyword">while</span>&nbsp;<span class="keyword">true</span>&nbsp;<span class="keyword">do</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;l&nbsp;=&nbsp;input&nbsp;ch&nbsp;b&nbsp;0&nbsp;block_size&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;f&nbsp;b&nbsp;0&nbsp;l;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">done</span>&nbsp;<span class="keyword">with</span>&nbsp;<span class="constructor">No_more_input</span>&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;()</code></p>
</div>
</div>

<pre><span id="VALreally_input"><span class="keyword">val</span> really_input</span> : <code class="type"><a href="BatIO.html#TYPEinput">input</a> -> Stdlib.Bytes.t -> int -> int -> int</code></pre><div class="info ">
<div class="info-desc">
<p><code class="code">really_input&nbsp;ic&nbsp;s&nbsp;p&nbsp;len</code> reads exactly <code class="code">len</code> characters from the
    input <code class="code">ic</code>, storing them in the string <code class="code">s</code>, starting at
    position <code class="code">p</code>. For consistency with <a href="BatIO.html#VALinput"><code class="code"><span class="constructor">BatIO</span>.input</code></a> it returns
    <code class="code">len</code>.</p>
</div>
<ul class="info-attributes">
<li><b>Raises</b><ul><li><code>No_more_input</code> if at <code class="code">len</code> characters are not
    available.</li>
<li><code>Invalid_argument</code> if <code class="code">p</code> and <code class="code">len</code> do not
    designate a valid substring of <code class="code">s</code>.

    Example: <code class="code"><span class="keyword">let</span>&nbsp;_&nbsp;=&nbsp;really_input&nbsp;stdin&nbsp;b&nbsp;0&nbsp;3</code></li>
</ul></li>
</ul>
</div>

<pre><span id="VALclose_in"><span class="keyword">val</span> close_in</span> : <code class="type"><a href="BatIO.html#TYPEinput">input</a> -> unit</code></pre><div class="info ">
<div class="info-desc">
<p>Close the input. It can no longer be read from.</p>

<p>Example: <code class="code">close_in&nbsp;network_in;</code></p>
</div>
</div>

<pre><span id="VALwrite"><span class="keyword">val</span> write</span> : <code class="type">(char, 'a) <a href="BatIO.html#TYPEprinter">printer</a></code></pre><div class="info ">
<div class="info-desc">
<p>Write a single char to an output.</p>

<p>Example: <code class="code">write&nbsp;stdout&nbsp;<span class="string">'x'</span>;</code></p>
</div>
</div>

<pre><span id="VALnwrite"><span class="keyword">val</span> nwrite</span> : <code class="type">(string, 'a) <a href="BatIO.html#TYPEprinter">printer</a></code></pre><div class="info ">
<div class="info-desc">
<p>Write a string to an output.</p>

<p>Example: <code class="code">nwrite&nbsp;stdout&nbsp;<span class="string">"Enter&nbsp;your&nbsp;name:&nbsp;"</span>;</code></p>
</div>
</div>

<pre><span id="VALoutput"><span class="keyword">val</span> output</span> : <code class="type">'a <a href="BatIO.html#TYPEoutput">output</a> -> Stdlib.Bytes.t -> int -> int -> int</code></pre><div class="info ">
<div class="info-desc">
<p><code class="code">output&nbsp;o&nbsp;s&nbsp;p&nbsp;len</code> writes up to <code class="code">len</code> characters from byte
    sequence <code class="code">s</code>, starting at offset <code class="code">p</code>. It returns the number of
    characters written. It will raise <code class="code"><span class="constructor">Invalid_argument</span></code> if <code class="code">p</code> and
    <code class="code">len</code> do not designate a valid subsequence of <code class="code">s</code>.</p>

<p>Example: <code class="code"><span class="keyword">let</span>&nbsp;written&nbsp;=&nbsp;output&nbsp;stdout&nbsp;(<span class="constructor">Bytes</span>.to_string&nbsp;<span class="string">"Foo&nbsp;Bar&nbsp;Baz"</span>)&nbsp;2&nbsp;4</code></p>

<p>This writes "o Ba" to stdout, and returns 4.</p>
</div>
</div>

<pre><span id="VALoutput_substring"><span class="keyword">val</span> output_substring</span> : <code class="type">'a <a href="BatIO.html#TYPEoutput">output</a> -> string -> int -> int -> int</code></pre><div class="info ">
<div class="info-desc">
<p>like <code class="code">output</code> above, but outputs from a substring instead of
    a subsequence of bytes</p>
</div>
<ul class="info-attributes">
<li><b>Since</b> 2.8.0</li>
</ul>
</div>

<pre><span id="VALreally_output"><span class="keyword">val</span> really_output</span> : <code class="type">'a <a href="BatIO.html#TYPEoutput">output</a> -> Stdlib.Bytes.t -> int -> int -> int</code></pre><div class="info ">
<div class="info-desc">
<p><code class="code">really_output&nbsp;o&nbsp;s&nbsp;p&nbsp;len</code> writes exactly <code class="code">len</code> characters from
    byte sequence <code class="code">s</code> onto the the output, starting with the character
    at offset <code class="code">p</code>. For consistency with <a href="BatIO.html#VALoutput"><code class="code"><span class="constructor">BatIO</span>.output</code></a> it returns
    <code class="code">len</code>.</p>
</div>
<ul class="info-attributes">
<li><b>Raises</b> <code>Invalid_argument</code> if <code class="code">p</code> and <code class="code">len</code> do not designate
    a valid subsequence of <code class="code">s</code>.

    This function is useful for networking situations where the output
    buffer might fill resulting in not the entire substring being
    readied for transmission.  Uses <code class="code">output</code> internally, and will
    raise <code class="code"><span class="constructor">Sys_blocked_io</span></code> in the case that any call returns 0.</li>
</ul>
</div>

<pre><span id="VALreally_output_substring"><span class="keyword">val</span> really_output_substring</span> : <code class="type">'a <a href="BatIO.html#TYPEoutput">output</a> -> string -> int -> int -> int</code></pre><div class="info ">
<div class="info-desc">
<p>like <code class="code">really_output</code> above, but outputs from a substring instead
    of a subsequence of bytes</p>
</div>
<ul class="info-attributes">
<li><b>Since</b> 2.8.0</li>
</ul>
</div>

<pre><span id="VALflush"><span class="keyword">val</span> flush</span> : <code class="type">'a <a href="BatIO.html#TYPEoutput">output</a> -> unit</code></pre><div class="info ">
<div class="info-desc">
<p>Flush an output.</p>

<p>If previous write operations have caused errors, this may trigger an exception.</p>

<p>Example: <code class="code">flush&nbsp;stdout;</code></p>
</div>
</div>

<pre><span id="VALflush_all"><span class="keyword">val</span> flush_all</span> : <code class="type">unit -> unit</code></pre><div class="info ">
<div class="info-desc">
<p>Flush all outputs, ignore errors.</p>

<p>Example: <code class="code">flush_all&nbsp;();</code></p>
</div>
</div>

<pre><span id="VALclose_out"><span class="keyword">val</span> close_out</span> : <code class="type">'a <a href="BatIO.html#TYPEoutput">output</a> -> 'a</code></pre><div class="info ">
<div class="info-desc">
<p>Close the output and return its accumulator data.</p>

<p>The output is flushed before being closed and can no longer be
    written. Attempting to flush or write after the output has been
    closed will have no effect.</p>

<p>Example: <code class="code"><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;strout&nbsp;=&nbsp;output_string&nbsp;()&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;write&nbsp;strout&nbsp;<span class="string">'x'</span>;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;2+3&gt;5&nbsp;<span class="keyword">then</span>&nbsp;write&nbsp;strout&nbsp;<span class="string">"y"</span>;<br>
&nbsp;&nbsp;&nbsp;&nbsp;print_string&nbsp;(close_out&nbsp;strout)&nbsp;</code></p>
</div>
</div>
<h7 id="6_CreationofBatIOInputsOutputs">Creation of BatIO Inputs/Outputs</h7>
<p>To open a file for reading/writing, see <code class="code"><span class="constructor">File</span>.open_in</code>
    and <code class="code"><span class="constructor">File</span>.open_out</code></p>

<pre><span id="VALinput_string"><span class="keyword">val</span> input_string</span> : <code class="type">string -> <a href="BatIO.html#TYPEinput">input</a></code></pre><div class="info ">
<div class="info-desc">
<p>Create an input that will read from a string.</p>

<p>Example: <code class="code"><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;inch&nbsp;=&nbsp;input_string&nbsp;<span class="string">"1234554321"</span>&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;str1&nbsp;=&nbsp;nread&nbsp;inch&nbsp;3&nbsp;<span class="keyword">in</span>&nbsp;<span class="comment">(*&nbsp;"123"&nbsp;*)</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;str2&nbsp;=&nbsp;nread&nbsp;inch&nbsp;5&nbsp;<span class="keyword">in</span>&nbsp;<span class="comment">(*&nbsp;"45543"&nbsp;*)</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;str3&nbsp;=&nbsp;nread&nbsp;inch&nbsp;2&nbsp;<span class="keyword">in</span>&nbsp;<span class="comment">(*&nbsp;"21"&nbsp;*)</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">try</span>&nbsp;string_of_char(read&nbsp;inch)&nbsp;<span class="keyword">with</span>&nbsp;<span class="constructor">BatIO</span>.<span class="constructor">No_more_input</span>&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="string">"End&nbsp;of&nbsp;string"</span>;<br>
&nbsp;&nbsp;&nbsp;&nbsp;</code></p>
</div>
</div>

<pre><span id="VALoutput_string"><span class="keyword">val</span> output_string</span> : <code class="type">unit -> string <a href="BatIO.html#TYPEoutput">output</a></code></pre><div class="info ">
<div class="info-desc">
<p>Create an output that will write into a string in an efficient way.
    When closed, the output returns all the data written into it.</p>
</div>
</div>

<pre><span id="VALinput_enum"><span class="keyword">val</span> input_enum</span> : <code class="type">char <a href="BatEnum.html#TYPEt">BatEnum.t</a> -> <a href="BatIO.html#TYPEinput">input</a></code></pre><div class="info ">
<div class="info-desc">
<p>Create an input that will read from an <code class="code">enum</code>.</p>
</div>
</div>

<pre><span id="VALoutput_enum"><span class="keyword">val</span> output_enum</span> : <code class="type">unit -> char <a href="BatEnum.html#TYPEt">BatEnum.t</a> <a href="BatIO.html#TYPEoutput">output</a></code></pre><div class="info ">
<div class="info-desc">
<p>Create an output that will write into an <code class="code">enum</code>. The
    final enum is returned when the output is closed.</p>
</div>
</div>

<pre><span id="VALcombine"><span class="keyword">val</span> combine</span> : <code class="type">'a <a href="BatIO.html#TYPEoutput">output</a> * 'b <a href="BatIO.html#TYPEoutput">output</a> -> ('a * 'b) <a href="BatIO.html#TYPEoutput">output</a></code></pre><div class="info ">
<div class="info-desc">
<p><code class="code">combine&nbsp;(a,b)</code> creates a new <code class="code">output</code> <code class="code">c</code> such that
    writing to <code class="code">c</code> will actually write to both <code class="code">a</code> and <code class="code">b</code></p>
</div>
</div>

<pre><span id="VALtab_out"><span class="keyword">val</span> tab_out</span> : <code class="type">?tab:char -> int -> 'a <a href="BatIO.html#TYPEoutput">output</a> -> unit <a href="BatIO.html#TYPEoutput">output</a></code></pre><div class="info ">
<div class="info-desc">
<p>Create an output shifted to the right by a number of spaces
    (or other character as specified by <code class="code">tab</code>).</p>

<p><code class="code">tab_out&nbsp;n&nbsp;out</code> produces a new output for writing into <code class="code">out</code>, in
    which every new line starts with <code class="code">n</code> spaces.</p>
</div>
<ul class="info-attributes">
<li><b>Raises</b> <code>Invalid_argument</code> if <code class="code">n</code> &lt; 0.

    Closing <code class="code">tab_out&nbsp;n&nbsp;out</code> does not close <code class="code">out</code>. Rather,
    closing <code class="code">out</code> closes <code class="code">tab_out&nbsp;n&nbsp;out</code>.</li>
</ul>
</div>
<h7 id="6_Utilities">Utilities</h7>
<pre><span id="VALread_all"><span class="keyword">val</span> read_all</span> : <code class="type"><a href="BatIO.html#TYPEinput">input</a> -> string</code></pre><div class="info ">
<div class="info-desc">
<p>read all the contents of the input until <code class="code"><span class="constructor">No_more_input</span></code> is raised.</p>
</div>
</div>

<pre><span id="VALpipe"><span class="keyword">val</span> pipe</span> : <code class="type">unit -> <a href="BatIO.html#TYPEinput">input</a> * unit <a href="BatIO.html#TYPEoutput">output</a></code></pre><div class="info ">
<div class="info-desc">
<p>Create a pipe between an input and an output. Data written from
    the output can be read from the input.</p>
</div>
</div>

<pre><span id="VALcopy"><span class="keyword">val</span> copy</span> : <code class="type">?buffer:int -> <a href="BatIO.html#TYPEinput">input</a> -> 'a <a href="BatIO.html#TYPEoutput">output</a> -> unit</code></pre><div class="info ">
<div class="info-desc">
<p>Read everything from an input and copy it to an output.</p>
</div>
</div>
<div class="param_info"><code class="code">buffer</code> : The size of the buffer to use for copying, in
    bytes. By default, this is 4,096b.</div>

<pre><span id="VALpos_in"><span class="keyword">val</span> pos_in</span> : <code class="type"><a href="BatIO.html#TYPEinput">input</a> -> <a href="BatIO.html#TYPEinput">input</a> * (unit -> int)</code></pre><div class="info ">
<div class="info-desc">
<p>Create an input that provide a count function of the number of bytes
    read from it.</p>
</div>
</div>

<pre><span id="VALprogress_in"><span class="keyword">val</span> progress_in</span> : <code class="type"><a href="BatIO.html#TYPEinput">input</a> -> (unit -> unit) -> <a href="BatIO.html#TYPEinput">input</a></code></pre><div class="info ">
<div class="info-desc">
<p><code class="code">progress_in&nbsp;inp&nbsp;f</code> create an input that calls <code class="code">f&nbsp;()</code>
    whenever some content is successfully read from it.</p>
</div>
</div>

<pre><span id="VALpos_out"><span class="keyword">val</span> pos_out</span> : <code class="type">'a <a href="BatIO.html#TYPEoutput">output</a> -> unit <a href="BatIO.html#TYPEoutput">output</a> * (unit -> int)</code></pre><div class="info ">
<div class="info-desc">
<p>Create an output that provide a count function of the number of bytes
    written through it.</p>
</div>
</div>

<pre><span id="VALprogress_out"><span class="keyword">val</span> progress_out</span> : <code class="type">'a <a href="BatIO.html#TYPEoutput">output</a> -> (unit -> unit) -> unit <a href="BatIO.html#TYPEoutput">output</a></code></pre><div class="info ">
<div class="info-desc">
<p><code class="code">progress_out&nbsp;out&nbsp;f</code> create an output that calls <code class="code">f&nbsp;()</code>
    whenever some content is successfully written to it.</p>
</div>
</div>

<pre><span id="VALcast_output"><span class="keyword">val</span> cast_output</span> : <code class="type">'a <a href="BatIO.html#TYPEoutput">output</a> -> unit <a href="BatIO.html#TYPEoutput">output</a></code></pre><div class="info ">
<div class="info-desc">
<p>You can safely transform any output to an unit output in a safe way
    by using this function.</p>
</div>
</div>
<h7 id="6_BinaryfilesAPI">Binary files API</h7>
<p>Here is some API useful for working with binary files, in particular
    binary files generated by C applications. By default, encoding of
    multibyte integers is low-endian. The <a href="BatIO.BigEndian.html"><code class="code"><span class="constructor">BatIO</span>.<span class="constructor">BigEndian</span></code></a> module provide multibyte
    operations with other encoding.</p>

<pre><span id="EXCEPTIONOverflow"><span class="keyword">exception</span> Overflow</span> <span class="keyword">of</span> <code class="type">string</code></pre>
<div class="info ">
<div class="info-desc">
<p>Exception raised when a read or write operation cannot be completed.</p>
</div>
</div>

<pre><span id="VALread_byte"><span class="keyword">val</span> read_byte</span> : <code class="type"><a href="BatIO.html#TYPEinput">input</a> -> int</code></pre><div class="info ">
<div class="info-desc">
<p>Read an unsigned 8-bit integer.</p>
</div>
</div>

<pre><span id="VALread_signed_byte"><span class="keyword">val</span> read_signed_byte</span> : <code class="type"><a href="BatIO.html#TYPEinput">input</a> -> int</code></pre><div class="info ">
<div class="info-desc">
<p>Read an signed 8-bit integer.</p>
</div>
</div>

<pre><span id="VALread_ui16"><span class="keyword">val</span> read_ui16</span> : <code class="type"><a href="BatIO.html#TYPEinput">input</a> -> int</code></pre><div class="info ">
<div class="info-desc">
<p>Read an unsigned 16-bit word.</p>
</div>
</div>

<pre><span id="VALread_i16"><span class="keyword">val</span> read_i16</span> : <code class="type"><a href="BatIO.html#TYPEinput">input</a> -> int</code></pre><div class="info ">
<div class="info-desc">
<p>Read a signed 16-bit word.</p>
</div>
</div>

<pre><span id="VALread_i32"><span class="keyword">val</span> read_i32</span> : <code class="type"><a href="BatIO.html#TYPEinput">input</a> -> int</code></pre><div class="info ">
<div class="info-desc">
<p>Read a signed 32-bit integer.</p>
</div>
<ul class="info-attributes">
<li><b>Raises</b> <code>Overflow</code> if the
    read integer cannot be represented as an OCaml 31-bit integer.</li>
</ul>
</div>

<pre><span id="VALread_real_i32"><span class="keyword">val</span> read_real_i32</span> : <code class="type"><a href="BatIO.html#TYPEinput">input</a> -> int32</code></pre><div class="info ">
<div class="info-desc">
<p>Read a signed 32-bit integer as an OCaml int32.</p>
</div>
</div>

<pre><span id="VALread_i64"><span class="keyword">val</span> read_i64</span> : <code class="type"><a href="BatIO.html#TYPEinput">input</a> -> int64</code></pre><div class="info ">
<div class="info-desc">
<p>Read a signed 64-bit integer as an OCaml int64.</p>
</div>
</div>

<pre><span id="VALread_float"><span class="keyword">val</span> read_float</span> : <code class="type"><a href="BatIO.html#TYPEinput">input</a> -> float</code></pre><div class="info ">
<div class="info-desc">
<p>Read an IEEE single precision floating point value.</p>
</div>
</div>

<pre><span id="VALread_double"><span class="keyword">val</span> read_double</span> : <code class="type"><a href="BatIO.html#TYPEinput">input</a> -> float</code></pre><div class="info ">
<div class="info-desc">
<p>Read an IEEE double precision floating point value.</p>
</div>
</div>

<pre><span id="VALread_string"><span class="keyword">val</span> read_string</span> : <code class="type"><a href="BatIO.html#TYPEinput">input</a> -> string</code></pre><div class="info ">
<div class="info-desc">
<p>Read a null-terminated string.</p>
</div>
</div>

<pre><span id="VALread_line"><span class="keyword">val</span> read_line</span> : <code class="type"><a href="BatIO.html#TYPEinput">input</a> -> string</code></pre><div class="info ">
<div class="info-desc">
<p>Read a LF or CRLF terminated string. If the source runs out of
    input before a LF is found, returns a string of the remaining input.
    Will raise <code class="code"><span class="constructor">No_more_input</span></code> only if no characters are available.</p>
</div>
</div>

<pre><span id="VALwrite_byte"><span class="keyword">val</span> write_byte</span> : <code class="type">(int, 'a) <a href="BatIO.html#TYPEprinter">printer</a></code></pre><div class="info ">
<div class="info-desc">
<p>Write an unsigned 8-bit byte.</p>
</div>
</div>

<pre><span id="VALwrite_ui16"><span class="keyword">val</span> write_ui16</span> : <code class="type">(int, 'a) <a href="BatIO.html#TYPEprinter">printer</a></code></pre><div class="info ">
<div class="info-desc">
<p>Write an unsigned 16-bit word.</p>
</div>
</div>

<pre><span id="VALwrite_i16"><span class="keyword">val</span> write_i16</span> : <code class="type">(int, 'a) <a href="BatIO.html#TYPEprinter">printer</a></code></pre><div class="info ">
<div class="info-desc">
<p>Write a signed 16-bit word.</p>
</div>
</div>

<pre><span id="VALwrite_i32"><span class="keyword">val</span> write_i32</span> : <code class="type">(int, 'a) <a href="BatIO.html#TYPEprinter">printer</a></code></pre><div class="info ">
<div class="info-desc">
<p>Write a signed 32-bit integer.</p>
</div>
</div>

<pre><span id="VALwrite_real_i32"><span class="keyword">val</span> write_real_i32</span> : <code class="type">(int32, 'a) <a href="BatIO.html#TYPEprinter">printer</a></code></pre><div class="info ">
<div class="info-desc">
<p>Write an OCaml int32.</p>
</div>
</div>

<pre><span id="VALwrite_i64"><span class="keyword">val</span> write_i64</span> : <code class="type">(int64, 'a) <a href="BatIO.html#TYPEprinter">printer</a></code></pre><div class="info ">
<div class="info-desc">
<p>Write an OCaml int64.</p>
</div>
</div>

<pre><span id="VALwrite_double"><span class="keyword">val</span> write_double</span> : <code class="type">(float, 'a) <a href="BatIO.html#TYPEprinter">printer</a></code></pre><div class="info ">
<div class="info-desc">
<p>Write an IEEE double precision floating point value.</p>
</div>
</div>

<pre><span id="VALwrite_float"><span class="keyword">val</span> write_float</span> : <code class="type">(float, 'a) <a href="BatIO.html#TYPEprinter">printer</a></code></pre><div class="info ">
<div class="info-desc">
<p>Write an IEEE single precision floating point value.</p>
</div>
</div>

<pre><span id="VALwrite_string"><span class="keyword">val</span> write_string</span> : <code class="type">(string, 'a) <a href="BatIO.html#TYPEprinter">printer</a></code></pre><div class="info ">
<div class="info-desc">
<p>Write a string and append an null character.</p>
</div>
</div>

<pre><span id="VALwrite_line"><span class="keyword">val</span> write_line</span> : <code class="type">(string, 'a) <a href="BatIO.html#TYPEprinter">printer</a></code></pre><div class="info ">
<div class="info-desc">
<p>Write a line and append a line end.</p>

<p>This adds the correct line end for your operating system.  That
    is, if you are writing to a file and your system imposes that
    files should end lines with character LF (or <code class="code"><span class="string">'\n'</span></code>), as Unix,
    then a LF is inserted at the end of the line. If your system
    favors CRLF (or <code class="code">'\r\n'</code>), then this is what will be inserted.</p>
</div>
</div>

<pre><span id="MODULEBigEndian"><span class="keyword">module</span> <a href="BatIO.BigEndian.html">BigEndian</a></span>: <code class="code"><span class="keyword">sig</span></code> <a href="BatIO.BigEndian.html">..</a> <code class="code"><span class="keyword">end</span></code></pre><div class="info">
<p>Same operations as module <a href="BatIO.html"><code class="code"><span class="constructor">BatIO</span></code></a>, but with big-endian encoding</p>

</div>
<h7 id="6_BitsAPI">Bits API</h7>
<p>This enable you to read and write from an BatIO bit-by-bit or several bits
    at the same time.</p>

<pre><span id="TYPEin_bits"><span class="keyword">type</span> <code class="type"></code>in_bits</span> </pre>


<pre><span id="TYPEout_bits"><span class="keyword">type</span> <code class="type"></code>out_bits</span> </pre>


<pre><span id="EXCEPTIONBits_error"><span class="keyword">exception</span> Bits_error</span></pre>

<pre><span id="VALinput_bits"><span class="keyword">val</span> input_bits</span> : <code class="type"><a href="BatIO.html#TYPEinput">input</a> -> <a href="BatIO.html#TYPEin_bits">in_bits</a></code></pre><div class="info ">
<div class="info-desc">
<p>Read bits from an input</p>
</div>
</div>

<pre><span id="VALoutput_bits"><span class="keyword">val</span> output_bits</span> : <code class="type">'a <a href="BatIO.html#TYPEoutput">output</a> -> <a href="BatIO.html#TYPEout_bits">out_bits</a></code></pre><div class="info ">
<div class="info-desc">
<p>Write bits to an output</p>
</div>
</div>

<pre><span id="VALread_bits"><span class="keyword">val</span> read_bits</span> : <code class="type"><a href="BatIO.html#TYPEin_bits">in_bits</a> -> int -> int</code></pre><div class="info ">
<div class="info-desc">
<p>Read up to 31 bits, raise Bits_error if n &lt; 0 or n &gt; 31</p>
</div>
</div>

<pre><span id="VALwrite_bits"><span class="keyword">val</span> write_bits</span> : <code class="type"><a href="BatIO.html#TYPEout_bits">out_bits</a> -> nbits:int -> int -> unit</code></pre><div class="info ">
<div class="info-desc">
<p>Write up to 31 bits represented as a value, raise Bits_error if nbits &lt; 0
    or nbits &gt; 31 or the value representation excess nbits.</p>
</div>
</div>

<pre><span id="VALflush_bits"><span class="keyword">val</span> flush_bits</span> : <code class="type"><a href="BatIO.html#TYPEout_bits">out_bits</a> -> unit</code></pre><div class="info ">
<div class="info-desc">
<p>Flush remaining unwritten bits, adding up to 7 bits which values 0.</p>
</div>
</div>

<pre><span id="VALdrop_bits"><span class="keyword">val</span> drop_bits</span> : <code class="type"><a href="BatIO.html#TYPEin_bits">in_bits</a> -> unit</code></pre><div class="info ">
<div class="info-desc">
<p>Drop up to 7 buffered bits and restart to next input character.</p>
</div>
</div>
<h7 id="6_Creatingnewtypesofinputsoutputs">Creating new types of inputs/outputs</h7>
<pre><span id="VALcreate_in"><span class="keyword">val</span> create_in</span> : <code class="type">read:(unit -> char) -><br>       input:(Stdlib.Bytes.t -> int -> int -> int) -><br>       close:(unit -> unit) -> <a href="BatIO.html#TYPEinput">input</a></code></pre><div class="info ">
<div class="info-desc">
<p>Fully create an input by giving all the needed functions.</p>

<p><b>Note</b> Do <em>not</em> use this function for creating an input
    which reads from one or more underlying inputs. Rather, use
    <a href="BatIO.html#VALwrap_in"><code class="code"><span class="constructor">BatIO</span>.wrap_in</code></a>.</p>
</div>
</div>

<pre><span id="VALwrap_in"><span class="keyword">val</span> wrap_in</span> : <code class="type">read:(unit -> char) -><br>       input:(Stdlib.Bytes.t -> int -> int -> int) -><br>       close:(unit -> unit) -> underlying:<a href="BatIO.html#TYPEinput">input</a> list -> <a href="BatIO.html#TYPEinput">input</a></code></pre><div class="info ">
<div class="info-desc">
<p>Fully create an input reading from other inputs by giving all
    the needed functions.</p>

<p>This function is a more general version of <a href="BatIO.html#VALcreate_in"><code class="code"><span class="constructor">BatIO</span>.create_in</code></a>
    which also handles dependency management between inputs.</p>

<p><b>Note</b> When you create an input which reads from another
    input, function <code class="code">close</code> should <em>not</em> close the inputs of
    <code class="code">underlying</code>. Doing so is a common error, which could result
    in inadvertently closing <a href="BatIO.html#VALstdin"><code class="code"><span class="constructor">BatIO</span>.stdin</code></a> or a network socket, etc.</p>
</div>
</div>

<pre><span id="VALinherit_in"><span class="keyword">val</span> inherit_in</span> : <code class="type">?read:(unit -> char) -><br>       ?input:(Stdlib.Bytes.t -> int -> int -> int) -><br>       ?close:(unit -> unit) -> <a href="BatIO.html#TYPEinput">input</a> -> <a href="BatIO.html#TYPEinput">input</a></code></pre><div class="info ">
<div class="info-desc">
<p>Simplified and optimized version of <a href="BatIO.html#VALwrap_in"><code class="code"><span class="constructor">BatIO</span>.wrap_in</code></a> which may be used
    whenever only one input appears as dependency.</p>

<p><code class="code">inherit_in&nbsp;inp</code> will return an input identical to <code class="code">inp</code>.
    <code class="code">inherit_in&nbsp;~read&nbsp;inp</code> will return an input identical to
    <code class="code">inp</code> except for method <code class="code">read</code>, etc.</p>

<p>You do not need to close <code class="code">inp</code> in <code class="code">close</code>.</p>
</div>
</div>

<pre><span id="VALcreate_out"><span class="keyword">val</span> create_out</span> : <code class="type">write:(char -> unit) -><br>       output:(Stdlib.Bytes.t -> int -> int -> int) -><br>       flush:(unit -> unit) -> close:(unit -> 'a) -> 'a <a href="BatIO.html#TYPEoutput">output</a></code></pre><div class="info ">
<div class="info-desc">
<p>Fully create an output by giving all the needed functions.</p>
</div>
</div>
<div class="param_info"><code class="code">write</code> : Write one character to the output (see <a href="BatIO.html#VALwrite"><code class="code"><span class="constructor">BatIO</span>.write</code></a>).</div>
<div class="param_info"><code class="code">output</code> : Write a (sub)string to the output (see <a href="BatIO.html#VALoutput"><code class="code"><span class="constructor">BatIO</span>.output</code></a>).</div>
<div class="param_info"><code class="code">flush</code> : Flush any buffers of this output  (see <a href="BatIO.html#VALflush"><code class="code"><span class="constructor">BatIO</span>.flush</code></a>).</div>
<div class="param_info"><code class="code">close</code> : Close this output. The output will be automatically
    flushed.

    <b>Note</b> Do <em>not</em> use this function for creating an output which
    writes to one or more underlying outputs. Rather, use <a href="BatIO.html#VALwrap_out"><code class="code"><span class="constructor">BatIO</span>.wrap_out</code></a>.</div>

<pre><span id="VALwrap_out"><span class="keyword">val</span> wrap_out</span> : <code class="type">write:(char -> unit) -><br>       output:(Stdlib.Bytes.t -> int -> int -> int) -><br>       flush:(unit -> unit) -><br>       close:(unit -> 'a) -> underlying:'b <a href="BatIO.html#TYPEoutput">output</a> list -> 'a <a href="BatIO.html#TYPEoutput">output</a></code></pre><div class="info ">
<div class="info-desc">
<p>Fully create an output that writes to one or more underlying outputs.</p>

<p>This function is a more general version of <a href="BatIO.html#VALcreate_out"><code class="code"><span class="constructor">BatIO</span>.create_out</code></a>,
   which also handles dependency management between outputs.</p>

<p>To illustrate the need for dependency management, let us consider
   the following values:</p>
<ul>
<li>an output <code class="code">out</code></li>
<li>a function <code class="code">f&nbsp;:&nbsp;_&nbsp;output&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;_&nbsp;output</code>, using <a href="BatIO.html#VALcreate_out"><code class="code"><span class="constructor">BatIO</span>.create_out</code></a> to
   create a new output for writing some data to an underyling
   output (for instance, a function comparale to <a href="BatIO.html#VALtab_out"><code class="code"><span class="constructor">BatIO</span>.tab_out</code></a> or a
   function performing transparent compression or transparent
   traduction between encodings)</li>
</ul>
<p>With these values, let us consider the following scenario</p>
<ul>
<li>a new output <code class="code">f&nbsp;out</code> is created</li>
<li>some data is written to <code class="code">f&nbsp;out</code> but not flushed</li>
<li>output <code class="code">out</code> is closed, perhaps manually or as a consequence
   of garbage-collection, or because the program has ended</li>
<li>data written to <code class="code">f&nbsp;out</code> is flushed.</li>
</ul>
<p>In this case, data reaches <code class="code">out</code> only after <code class="code">out</code> has been closed.
   Despite appearances, it is quite easy to reach such situation,
   especially in short programs.</p>

<p>If, instead, <code class="code">f</code> uses <code class="code">wrap_out</code>, then when output <code class="code">out</code> is closed,
   <code class="code">f&nbsp;out</code> is first automatically flushed and closed, which avoids the
   issue.</p>
</div>
</div>
<div class="param_info"><code class="code">write</code> : Write one character to the output (see <a href="BatIO.html#VALwrite"><code class="code"><span class="constructor">BatIO</span>.write</code></a>).</div>
<div class="param_info"><code class="code">output</code> : Write a (sub)string to the output (see <a href="BatIO.html#VALoutput"><code class="code"><span class="constructor">BatIO</span>.output</code></a>).</div>
<div class="param_info"><code class="code">flush</code> : Flush any buffers of this output  (see <a href="BatIO.html#VALflush"><code class="code"><span class="constructor">BatIO</span>.flush</code></a>).</div>
<div class="param_info"><code class="code">close</code> : Close this output. The output will be automatically
   flushed.</div>
<div class="param_info"><code class="code">underlying</code> : The list of outputs to which the new output will
   write.

   <b>Note</b> Function <code class="code">close</code> should <em>not</em> close <code class="code">underlying</code>
   yourself. This is a common mistake which may cause sockets or
   standard output to be closed while they are still being used by
   another part of the program.</div>

<pre><span id="VALinherit_out"><span class="keyword">val</span> inherit_out</span> : <code class="type">?write:(char -> unit) -><br>       ?output:(Stdlib.Bytes.t -> int -> int -> int) -><br>       ?flush:(unit -> unit) -><br>       ?close:(unit -> unit) -> 'a <a href="BatIO.html#TYPEoutput">output</a> -> unit <a href="BatIO.html#TYPEoutput">output</a></code></pre><div class="info ">
<div class="info-desc">
<p>Simplified and optimized version of <a href="BatIO.html#VALwrap_out"><code class="code"><span class="constructor">BatIO</span>.wrap_out</code></a> whenever only
   one output appears as dependency.</p>

<p><code class="code">inherit_out&nbsp;out</code> will return an output identical to <code class="code">out</code>.
   <code class="code">inherit_out&nbsp;~write&nbsp;out</code> will return an output identical to
   <code class="code">out</code> except for its <code class="code">write</code> method, etc.</p>

<p>You do not need to close <code class="code">out</code> in <code class="code">close</code>.</p>
</div>
</div>
<h7 id="6_Forcompatibilitypurposes">For compatibility purposes</h7>
<pre><span id="VALinput_channel"><span class="keyword">val</span> input_channel</span> : <code class="type">?autoclose:bool -> ?cleanup:bool -> Stdlib.in_channel -> <a href="BatIO.html#TYPEinput">input</a></code></pre><div class="info ">
<div class="info-desc">
<p>Create an input that will read from a channel.</p>
</div>
</div>
<div class="param_info"><code class="code">autoclose</code> : If true or unspecified, the <a href="BatIO.html#TYPEinput"><code class="code"><span class="constructor">BatIO</span>.input</code></a>
    will be automatically closed when the underlying <code class="code">in_channel</code>
    has reached its end.</div>
<div class="param_info"><code class="code">cleanup</code> : If true, the channel
    will be automatically closed when the <a href="BatIO.html#TYPEinput"><code class="code"><span class="constructor">BatIO</span>.input</code></a> is closed.
    Otherwise, you will need to close the channel manually.</div>

<pre><span id="VALoutput_channel"><span class="keyword">val</span> output_channel</span> : <code class="type">?cleanup:bool -> Stdlib.out_channel -> unit <a href="BatIO.html#TYPEoutput">output</a></code></pre><div class="info ">
<div class="info-desc">
<p>Create an output that will write into a channel.</p>
</div>
</div>
<div class="param_info"><code class="code">cleanup</code> : If true, the channel
    will be automatically closed when the <a href="BatIO.html#TYPEoutput"><code class="code"><span class="constructor">BatIO</span>.output</code></a> is closed.
    Otherwise, you will need to close the channel manually.</div>

<pre><span id="VALto_input_channel"><span class="keyword">val</span> to_input_channel</span> : <code class="type"><a href="BatIO.html#TYPEinput">input</a> -> Stdlib.in_channel</code></pre><div class="info ">
<div class="info-desc">
<p>Create a channel that will read from an input.</p>

<p><b>Note</b> This function is extremely costly and is provided
    essentially for debugging purposes or for reusing legacy
    libraries which can't be adapted. As a general rule, if
    you can avoid using this function, don't use it.</p>
</div>
</div>
<h7 id="6_GenericBatIOObjectWrappers">Generic BatIO Object Wrappers</h7>
<p>These OO Wrappers have been written to provide easy support of
    BatIO by external libraries. If you want your library to support
    BatIO without actually requiring Batteries to compile, you can
    implement the classes <code class="code">in_channel</code>, <code class="code">out_channel</code>,
    <code class="code">poly_in_channel</code> and/or <code class="code">poly_out_channel</code> which are the common
    BatIO specifications established for ExtLib, OCamlNet and
    Camomile.</p>

<p>(see http://www.ocaml-programming.de/tmp/BatIO-Classes.html for more details).</p>

<p><b>Note</b> In this version of Batteries Included, the object wrappers are <em>not</em>
    closed automatically by garbage-collection.</p>

<pre><span id="TYPEin_channel"><span class="keyword">class</span> <a href="BatIO.in_channel-c.html">in_channel</a></span> : <code class="type"><a href="BatIO.html#TYPEinput">input</a> -> </code><code class="code"><span class="keyword">object</span></code> <a href="BatIO.in_channel-c.html">..</a> <code class="code"><span class="keyword">end</span></code></pre>
<pre><span id="TYPEout_channel"><span class="keyword">class</span> <a href="BatIO.out_channel-c.html">out_channel</a></span> : <code class="type">'a <a href="BatIO.html#TYPEoutput">output</a> -> </code><code class="code"><span class="keyword">object</span></code> <a href="BatIO.out_channel-c.html">..</a> <code class="code"><span class="keyword">end</span></code></pre>
<pre><span id="TYPEin_chars"><span class="keyword">class</span> <a href="BatIO.in_chars-c.html">in_chars</a></span> : <code class="type"><a href="BatIO.html#TYPEinput">input</a> -> </code><code class="code"><span class="keyword">object</span></code> <a href="BatIO.in_chars-c.html">..</a> <code class="code"><span class="keyword">end</span></code></pre>
<pre><span id="TYPEout_chars"><span class="keyword">class</span> <a href="BatIO.out_chars-c.html">out_chars</a></span> : <code class="type">'a <a href="BatIO.html#TYPEoutput">output</a> -> </code><code class="code"><span class="keyword">object</span></code> <a href="BatIO.out_chars-c.html">..</a> <code class="code"><span class="keyword">end</span></code></pre>
<pre><span id="VALfrom_in_channel"><span class="keyword">val</span> from_in_channel</span> : <code class="type">#<a href="BatIO.in_channel-c.html">in_channel</a> -> <a href="BatIO.html#TYPEinput">input</a></code></pre>
<pre><span id="VALfrom_out_channel"><span class="keyword">val</span> from_out_channel</span> : <code class="type">#<a href="BatIO.out_channel-c.html">out_channel</a> -> unit <a href="BatIO.html#TYPEoutput">output</a></code></pre>
<pre><span id="VALfrom_in_chars"><span class="keyword">val</span> from_in_chars</span> : <code class="type">#<a href="BatIO.in_chars-c.html">in_chars</a> -> <a href="BatIO.html#TYPEinput">input</a></code></pre>
<pre><span id="VALfrom_out_chars"><span class="keyword">val</span> from_out_chars</span> : <code class="type">#<a href="BatIO.out_chars-c.html">out_chars</a> -> unit <a href="BatIO.html#TYPEoutput">output</a></code></pre><h7 id="6_EnumerationAPI">Enumeration API</h7>
<pre><span id="VALbytes_of"><span class="keyword">val</span> bytes_of</span> : <code class="type"><a href="BatIO.html#TYPEinput">input</a> -> int <a href="BatEnum.html#TYPEt">BatEnum.t</a></code></pre><div class="info ">
<div class="info-desc">
<p>Read an enumeration of unsigned 8-bit integers.</p>
</div>
</div>

<pre><span id="VALsigned_bytes_of"><span class="keyword">val</span> signed_bytes_of</span> : <code class="type"><a href="BatIO.html#TYPEinput">input</a> -> int <a href="BatEnum.html#TYPEt">BatEnum.t</a></code></pre><div class="info ">
<div class="info-desc">
<p>Read an enumeration of signed 8-bit integers.</p>
</div>
</div>

<pre><span id="VALui16s_of"><span class="keyword">val</span> ui16s_of</span> : <code class="type"><a href="BatIO.html#TYPEinput">input</a> -> int <a href="BatEnum.html#TYPEt">BatEnum.t</a></code></pre><div class="info ">
<div class="info-desc">
<p>Read an enumeration of unsigned 16-bit words.</p>
</div>
</div>

<pre><span id="VALi16s_of"><span class="keyword">val</span> i16s_of</span> : <code class="type"><a href="BatIO.html#TYPEinput">input</a> -> int <a href="BatEnum.html#TYPEt">BatEnum.t</a></code></pre><div class="info ">
<div class="info-desc">
<p>Read an enumartion of signed 16-bit words.</p>
</div>
</div>

<pre><span id="VALi32s_of"><span class="keyword">val</span> i32s_of</span> : <code class="type"><a href="BatIO.html#TYPEinput">input</a> -> int <a href="BatEnum.html#TYPEt">BatEnum.t</a></code></pre><div class="info ">
<div class="info-desc">
<p>Read an enumeration of signed 32-bit integers.</p>
</div>
<ul class="info-attributes">
<li><b>Raises</b> <code>Overflow</code> if the
    read integer cannot be represented as an OCaml 31-bit integer.</li>
</ul>
</div>

<pre><span id="VALreal_i32s_of"><span class="keyword">val</span> real_i32s_of</span> : <code class="type"><a href="BatIO.html#TYPEinput">input</a> -> int32 <a href="BatEnum.html#TYPEt">BatEnum.t</a></code></pre><div class="info ">
<div class="info-desc">
<p>Read an enumeration of signed 32-bit integers as OCaml <code class="code">int32</code>s.</p>
</div>
</div>

<pre><span id="VALi64s_of"><span class="keyword">val</span> i64s_of</span> : <code class="type"><a href="BatIO.html#TYPEinput">input</a> -> int64 <a href="BatEnum.html#TYPEt">BatEnum.t</a></code></pre><div class="info ">
<div class="info-desc">
<p>Read an enumeration of signed 64-bit integers as OCaml <code class="code">int64</code>s.</p>
</div>
</div>

<pre><span id="VALdoubles_of"><span class="keyword">val</span> doubles_of</span> : <code class="type"><a href="BatIO.html#TYPEinput">input</a> -> float <a href="BatEnum.html#TYPEt">BatEnum.t</a></code></pre><div class="info ">
<div class="info-desc">
<p>Read an enumeration of IEEE double precision floating point values.</p>
</div>
</div>

<pre><span id="VALfloats_of"><span class="keyword">val</span> floats_of</span> : <code class="type"><a href="BatIO.html#TYPEinput">input</a> -> float <a href="BatEnum.html#TYPEt">BatEnum.t</a></code></pre><div class="info ">
<div class="info-desc">
<p>Read an enumeration of IEEE single precision floating point values.</p>
</div>
</div>

<pre><span id="VALstrings_of"><span class="keyword">val</span> strings_of</span> : <code class="type"><a href="BatIO.html#TYPEinput">input</a> -> string <a href="BatEnum.html#TYPEt">BatEnum.t</a></code></pre><div class="info ">
<div class="info-desc">
<p>Read an enumeration of null-terminated strings.</p>
</div>
</div>

<pre><span id="VALlines_of"><span class="keyword">val</span> lines_of</span> : <code class="type"><a href="BatIO.html#TYPEinput">input</a> -> string <a href="BatEnum.html#TYPEt">BatEnum.t</a></code></pre><div class="info ">
<div class="info-desc">
<p>Read an enumeration of LF or CRLF terminated strings.</p>
</div>
</div>

<pre><span id="VALlines_of2"><span class="keyword">val</span> lines_of2</span> : <code class="type"><a href="BatIO.html#TYPEinput">input</a> -> string <a href="BatEnum.html#TYPEt">BatEnum.t</a></code></pre>
<pre><span id="VALchunks_of"><span class="keyword">val</span> chunks_of</span> : <code class="type">int -> <a href="BatIO.html#TYPEinput">input</a> -> string <a href="BatEnum.html#TYPEt">BatEnum.t</a></code></pre><div class="info ">
<div class="info-desc">
<p>Read an input as an enumeration of strings of given length.  If the input isn't a multiple of that length, the final string will be smaller than the rest.</p>
</div>
</div>

<pre><span id="VALchars_of"><span class="keyword">val</span> chars_of</span> : <code class="type"><a href="BatIO.html#TYPEinput">input</a> -> char <a href="BatEnum.html#TYPEt">BatEnum.t</a></code></pre><div class="info ">
<div class="info-desc">
<p>Read an enumeration of Latin-1 characters.</p>

<p><b>Note</b> Usually faster than calling <code class="code">read</code> several times.</p>
</div>
</div>

<pre><span id="VALbits_of"><span class="keyword">val</span> bits_of</span> : <code class="type"><a href="BatIO.html#TYPEin_bits">in_bits</a> -> int <a href="BatEnum.html#TYPEt">BatEnum.t</a></code></pre><div class="info ">
<div class="info-desc">
<p>Read an enumeration of bits</p>
</div>
</div>

<pre><span id="VALwrite_bitss"><span class="keyword">val</span> write_bitss</span> : <code class="type">nbits:int -> <a href="BatIO.html#TYPEout_bits">out_bits</a> -> int <a href="BatEnum.html#TYPEt">BatEnum.t</a> -> unit</code></pre><div class="info ">
<div class="info-desc">
<p>Write an enumeration of bits</p>
</div>
</div>

<pre><span id="VALdefault_buffer_size"><span class="keyword">val</span> default_buffer_size</span> : <code class="type">int</code></pre><div class="info ">
<div class="info-desc">
<p>The default size for internal buffers.</p>
</div>
</div>
<h7 id="6_Threadsafety">Thread-safety</h7>
<pre><span id="VALsynchronize_in"><span class="keyword">val</span> synchronize_in</span> : <code class="type">?lock:<a href="BatConcurrent.html#TYPElock">BatConcurrent.lock</a> -> <a href="BatIO.html#TYPEinput">input</a> -> <a href="BatIO.html#TYPEinput">input</a></code></pre><div class="info ">
<div class="info-desc">
<p><code class="code">synchronize_in&nbsp;inp</code> produces a new <a href="BatIO.html#TYPEinput"><code class="code"><span class="constructor">BatIO</span>.input</code></a> which reads from <code class="code">input</code>
   in a thread-safe way. In other words, a lock prevents two distinct threads
   from reading from that input simultaneously, something which would potentially
   wreak havoc otherwise</p>
</div>
</div>
<div class="param_info"><code class="code">lock</code> : An optional lock. If none is provided, the lock will be specific
   to this <code class="code">input</code>. Specifying a custom lock may be useful to associate one
   common lock for several inputs and/or outputs, for instance in the case
   of pipes.</div>

<pre><span id="VALsynchronize_out"><span class="keyword">val</span> synchronize_out</span> : <code class="type">?lock:<a href="BatConcurrent.html#TYPElock">BatConcurrent.lock</a> -> 'a <a href="BatIO.html#TYPEoutput">output</a> -> unit <a href="BatIO.html#TYPEoutput">output</a></code></pre><div class="info ">
<div class="info-desc">
<p><code class="code">synchronize_out&nbsp;out</code> produces a new <a href="BatIO.html#TYPEoutput"><code class="code"><span class="constructor">BatIO</span>.output</code></a> which writes to <code class="code">output</code>
   in a thread-safe way. In other words, a lock prevents two distinct threads
   from writing to that output simultaneously, something which would potentially
   wreak havoc otherwise</p>
</div>
</div>
<div class="param_info"><code class="code">lock</code> : An optional lock. If none is provided, the lock will be specific
   to this <code class="code">output</code>. Specifying a custom lock may be useful to associate one
   common lock for several inputs and/or outputs, for instance in the case
   of pipes.</div>
<h7 id="6_Threadsafetyinternals">Thread-safety internals</h7>
<p>Unless you are attempting to adapt Batteries Included to a new model of
   concurrency, you probably won't need this.</p>

<pre><span id="VALlock"><span class="keyword">val</span> lock</span> : <code class="type"><a href="BatConcurrent.html#TYPElock">BatConcurrent.lock</a> Stdlib.ref</code></pre><div class="info ">
<div class="info-desc">
<p>A lock used to synchronize internal operations.</p>

<p>By default, this is <a href="BatConcurrent.html#VALnolock"><code class="code"><span class="constructor">BatConcurrent</span>.nolock</code></a>. However, if you're
   using a version of Batteries compiled in threaded mode, this uses
   <a href="BatMutex.html"><code class="code"><span class="constructor">BatMutex</span></code></a>. If you're attempting to use Batteries with another
   concurrency model, set the lock appropriately.</p>
</div>
</div>

<pre><span id="VALlock_factory"><span class="keyword">val</span> lock_factory</span> : <code class="type">(unit -> <a href="BatConcurrent.html#TYPElock">BatConcurrent.lock</a>) Stdlib.ref</code></pre><div class="info ">
<div class="info-desc">
<p>A factory used to create locks. This is used transparently by <a href="BatIO.html#VALsynchronize_in"><code class="code"><span class="constructor">BatIO</span>.synchronize_in</code></a>
   and <a href="BatIO.html#VALsynchronize_out"><code class="code"><span class="constructor">BatIO</span>.synchronize_out</code></a>.</p>

<p>By default, this always returns <a href="BatConcurrent.html#VALnolock"><code class="code"><span class="constructor">BatConcurrent</span>.nolock</code></a>. However,
   if you're using a version of Batteries compiled in threaded mode,
   this uses <a href="BatMutex.html"><code class="code"><span class="constructor">BatMutex</span></code></a>.</p>
</div>
</div>

<pre><span id="VALto_string"><span class="keyword">val</span> to_string</span> : <code class="type">('a, string) <a href="BatIO.html#TYPEprinter">printer</a> -> 'a -> string</code></pre>
<pre><span id="VALto_f_printer"><span class="keyword">val</span> to_f_printer</span> : <code class="type">('a, 'b) <a href="BatIO.html#TYPEprinter">printer</a> -> 'a <a href="BatIO.html#TYPEf_printer">f_printer</a></code></pre></body></html>
